# [TMUCTF2021](https://ctftime.org/event/1427)

<img align="left" width="200" height="175" src="https://user-images.githubusercontent.com/68913871/132789141-88a5c5cb-646a-448f-8afc-f676690dda1d.png">

&nbsp; 42 hours Jeopardy-Style  
&nbsp; Wed, 08 Sept. 2021, 18:30 SGT â€” Fri, 10 Sept. 2021, 12:30 SGT  

&nbsp; **Team Name:** *Rookie441*  
&nbsp; **Team Member(s):**  
&nbsp; 1. *Lee Wen Bin Andre*  

<br/><br>

| Challenge | Category |
| --- | --- |
| [Warmup](#warmup)	| Misc |
| [Login](#login)	| Web |
| [Puzzle](#puzzle) | Misc |
| [Prison](#prison) | Misc |

## Warmup

![image](https://user-images.githubusercontent.com/68913871/132789734-94fc8998-72e0-45a5-90be-81bed540c321.png)  
[challenge.zip](https://github.com/Rookie441/CTF/files/7140897/challenge.zip)

> The zip file contains 2 images: `ciphered_message` and `secret`. The 2 files are generated by visual cryptography as suggested by the challenge description. Read more about [visual crypto](https://github.com/ageron/visual_crypto)

![image](https://user-images.githubusercontent.com/68913871/132792870-25f6312e-414a-4ddb-ba46-efb8bf5e972a.png)

> Overlap the secret and ciphered images together and adjust the transparency until we can see the flag.

![image](https://user-images.githubusercontent.com/68913871/132789936-a117b1dd-9e09-4d82-907c-7b69e16dada2.png)

`TMUCTF{W3_h0p3_y0u_3nj0y_7h15_c0mp371710n_4nd_7h4nk_y0u!}`

## Login

![image](https://user-images.githubusercontent.com/68913871/132793013-f4dbbeaf-5a72-452f-98b8-a3bd439341a3.png)

> Navigating to the address shows us a login page requesting a password.

![image](https://user-images.githubusercontent.com/68913871/132793106-24c74cd9-77bf-49e0-ba97-c73d1e938137.png)

> View page source, we can see that the page uses php.

```html
<link rel="stylesheet" type="text/css" href="style.css">
<title>Login Page</title>
<form class="box" action="login.php" method="get">
  <h1>Welcome to TMUCTF 2021</h1>
  <h3>Just login and get the flag:</h3>
  <input type="password" name="password" placeholder="Password">
  <input type="submit" value="Login" />
</form>
```

> Navigate to /robots.txt

```txt
if (isset($_GET["password"])) {
    if (hash("md5", $_GET["password"]) == $_GET["password"]) {
        echo "<h1>Here is the flag:</h1>" . $flag;
    } else {
        echo "Try harder!";
    }
}
```

> The approach to this challenge is adapted from a similar challenge from another CTF shown in [this writeup](https://ctftime.org/writeup/12065).

> Here, we see a vulnerability. The comparison in the if condition is done with `==` instead of `===`. This mean that the comparison returns true also if both strings are scientific number, so we just need to find a string which hash is like: `0e + some digits`.

> The following is a python script taken [here](https://github.com/bl4de/ctf/blob/master/2017/HackDatKiwi_CTF_2017/md5games1/md5games1.md), which uses bruteforce to give us the required string: `0e215962017`

```python
#!/usr/bin/env python
import hashlib
import re

prefix = '0e'

def breakit():
    iters = 0
    while 1:
        s = prefix + str(iters)
        hashed_s = hashlib.md5(s).hexdigest()
        iters = iters + 1
        r = re.match('^0e[0-9]{30}', hashed_s)
        if r:
            print "[+] found! md5( {} ) ---> {}".format(s, hashed_s)
            print "[+] in {} iterations".format(iters)
            exit(0)

        if iters % 1000000 == 0:
            print "[+] current value: {}       {} iterations, continue...".format(s, iters)

breakit()
```

> Entering the string as the password gave us the flag since the statement `if (hash("md5", $_GET["password"]) == $_GET["password"])` will equate to true.

`TMUCTF{D0_y0u_kn0w_7h3_d1ff3r3nc3_b37w33n_L0053_c0mp4r150n_4nd_57r1c7_c0mp4r150n_1n_PHP!?}`

## Puzzle

![image](https://user-images.githubusercontent.com/68913871/132794700-67ac34c4-5795-4503-80d6-fdfa7652097b.png)  
[challenge.zip](https://github.com/Rookie441/CTF/files/7141057/challenge.1.zip)

> Extract using 7Zip, we see a `flag.txt` file protected by a password as well as another `puzzle.png` shown below:

![image](https://user-images.githubusercontent.com/68913871/132794707-ed9ecb50-7e05-4101-b4ff-b42d4534a1a4.png)

> There is a pattern to this puzzle, and it is nothing mathematical. From 12 to 11112, firstly, we put a 1, then we count how many of what numbers is in the previous line. In this case, there is one 1 and one 2. Thus, we append 11 and 12. We get: 11112

> From 11112 to 24112, firstly, we put a 2, then we count how many of what numbers is in the previous line. In this case, there is four 1 and one 2. Thus, we append 41 and 12. We get: 24112

> As we carry on, we get the `?` to be `61542142311`.

> Extract `flag.txt` using the password above. We get:

```txt
R1pIUEdTe1EzeV9NM19RNDU3NHpfRTRzNzBfVzRhX1U0el9PMV9RM3kwX1c0YV9QdTAwYV9YMGE0en0=
```

> Base 64 decoding gives us:

```txt
GZHPGS{Q3y_M3_Q4574z_E4s70_W4a_U4z_O1_Q3y0_W4a_Pu00a_X0a4z}
```

> ROT13 to get the flag:

`TMUCTF{D3l_Z3_D4574m_R4f70_J4n_H4m_B1_D3l0_J4n_Ch00n_K0n4m}`

## Prison

![image](https://user-images.githubusercontent.com/68913871/132795501-a2d50ead-52c2-4e20-85bf-22904323c61e.png)

> `challenge.txt` is a text file containing numerous dots and spaces.

```txt
.... .... .. ... . ..... ... ..... .... .. .. .... .... ... ... .... ... ... . ..... .... .. .. .... .... ... .... .... .... .. ..... .... .. .... ... ... .. .. .... .... ... .... . ..... .... ... . ... . . ... ..... . ..... .. . .... .. ... .... ... .. .. ... .. .... .... ... . ... . ..... ... . ... .
```

> On first look, it might be morse code or binary(where `.` represents 1 and `spaces` represents 0). However, those approaches did not get us anywhere.

> Upon looking at the challenge name and description, it led me to think about how prisoners communicate with one another secretly. Discovered about [Tap code](https://en.wikipedia.org/wiki/Tap_code).

> Each letter is communicated by tapping two numbers. Starting from the top left, the first designating the row (Pause) the second designating the column.

> For example, to specify the letter "B", one taps once, pauses, and then taps twice.

![image](https://user-images.githubusercontent.com/68913871/132796582-a61d7b23-7cb7-4bc5-8c78-78785bb187c9.png)

> Doing it manually, we get (row,col):

```txt
44 23 15 35 42 24 43 34 33 15 42 24 43 44 42 54 24 33 22 44 34 15 43 13 11 35 15 21 42 34 32 23 24 43 13 15 31 31
```

> The output is obtained using the above table to get:

```txt
THEPRISONERISTRYINGTOESCAPEFROMHISCELL
```

> Alternatively, we can just use this handy [online tool](https://cryptii.com/pipes/tap-code).

`TMUCTF{THEPRISONERISTRYINGTOESCAPEFROMHISCELL}`

## [Go to Top](#tmuctf2021)
