## Spooky

> Navigating to the site, we are faced with a login screen

![image](https://github.com/Rookie441/CTF/blob/main/Categories/Web%20Exploitation/Easy/spooky/login.png)

> Since there is no source code provided, I tried SQL injections but it did not work. I then began to make GET requests to `/robots.txt` and `/sitemap.xml` which are the two common places to look at in web CTF challenges. And indeed, I found something in sitemap.xml

```XML
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
<url>
<loc>/creds/users.txt</loc>
<lastmod>2023-03-29T09:12:48+01:00</lastmod>
<priority>1.0</priority>
</url>
<url>
<loc>/creds/pass.txt</loc>
<lastmod>2023-03-29T09:12:48+01:00</lastmod>
<priority>1.0</priority>
</url>
</urlset>
```

> Upon visiting the above paths, we can gather the usernames and passwords as follows:

```
user
guest
root
admin
kali
raspberry
support
fiona
charles
alice
pinocchio
shrekop
dragon
donkey
wolf
```

```
R4YPLtCnaMc8GhWy
fX9maZjLNdqKG8wH
r6GUEungvhXqVFyY
WZLNBAdkXc6Yu8rh
ny7Z2jpMT36CBwLH
VmU5gnXKYN2vLp48
VGUtajxuq6KeNk5J
XZTEVmd6AcFN3j84
ydfkG8YS7WMwpQNC
emcYJrGFVMakw5UN
G9fBSNbgmhTduKEU
KctkRurdy4vSMGWF
Ggc6qyrVdDzWhEea
DKaYNZug9ELCzRAy
NwCGR69ZceHu8tmT
```

> Here, we will learn how to use Burp Intruder to bruteforce the credentials login process.

> We first go to the `positions` tab and set our attack type to `Cluster Bomb`. This attack iterates through a different payload set for each defined position. Payloads are placed from each set in turn, so that all payload combinations are tested. You can read more on the other attack types [here](https://portswigger.net/burp/documentation/desktop/tools/intruder/configure-attack/attack-types)

> We also indicate our payload positions by highlighting our inputs to user and pass, then clicking `Add ยง`

![image](https://github.com/Rookie441/CTF/blob/main/Categories/Web%20Exploitation/Easy/spooky/payloadpos.png)

> After that, we navigate to the `payloads` tab. Under `Payload Sets`, we can set Payload set 1 to be the list of usernames, and Payload set 2 to be the list of passwords. Then, click on `Start Attack`

![image](https://github.com/Rookie441/CTF/blob/main/Categories/Web%20Exploitation/Easy/spooky/attack.png)

> We can view the request and response in the window as shown. We can also sort according to the content length to filter out unique responses.

![image](https://github.com/Rookie441/CTF/blob/main/Categories/Web%20Exploitation/Easy/spooky/attacksuccess.png)

> We can see that we have successfully logged in with the credentials `shrekop:VmU5gnXKYN2vLp48`

> Now, some guesswork is needed to determine that we needed an extra parameter `admin`, with its value set to `true`. By sending the POST request using the Repeater, we get the following response which contains our flag.

![image](https://github.com/Rookie441/CTF/blob/main/Categories/Web%20Exploitation/Easy/spooky/Solved.png)

`VishwaCTF{h1dd3n_P@raMs}`
